## Предварительно

Создаём чистое виртуальное украшение, а затем устанавливаем все зависимости через `poetry`

```
poetry install
```

А затем скачиваем данные через `dvc`

```
dvc pull
```

## Второе задание

Запускаем скрипт

```
python code/hw_2.py
```

Код сгенерирует 4 файла с разным `SNR`: -5, 0, 5 и 10 -- и сохранит в папку
`/output/hw_2/`. Также прогонит их через доступные в `torchmetrics` метрики
`SignalDistortionRatio`, `ScaleInvariantSignalDistortionRatio` и
`PerceptualEvaluationSpeechQuality` и выведет результаты. Результаты работы
NISQA представлены скрином ниже, а результат работы `DNSMOS` представлены в виду
файла `/output/hw_2/sample.csv`. Также все результаты представлены в таблице
ниже.

![NISQA results](/pics/nisqa_hw2.jpg "NISQA results for generated files")



| файл | SNR | SDR | SI-SDR | PESQ | NISQA(mos_pred) | NISQA(noi_pred) | NISQA(dis_pred) | NISQA(col_pred) | NISQA(loud_pred) | DNSMOS | MOS |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| `snr-5.wav` | -5 | -9.234993 | -9.270756 | 1.0675446 | 0.604121 | 1.378376 | 2.705365 | 1.193014 | 1.404781 | 2.198392 | 1 |
| `snr_0.wav` | 0 | -4.2377 | -4.2515864 | 1.0548806 | 0.729355 | 1.345632 | 2.989924 | 1.434083 | 1.551345 | 2.3233156 | 2 |
| `snr_5.wav` | 5 | 0.766157 | 0.75917494 | 1.0769463 | 1.121786 | 1.315253 | 4.240198 | 2.908588 | 2.477383 | 2.4289048 | 2 |
| `snr_10.wav` | 10 | 5.7700233 | 5.7652206 | 1.1613451 | 2.027135 | 1.249655 | 4.376255 | 3.407032 | 3.099280 | 2.7627323 | 4 |
| `snr_-5_DeepFilterNet3.wav` | 2.1847632 | -0.3247673 | -1.7007704 | 1.1593353 | --- | --- | --- | --- | --- | --- | 1 |
| `snr_0_DeepFilterNet3.wav` | 5.974484 | 5.4281497 | 4.793428 | 1.4118621 | --- | --- | --- | --- | --- | --- | 1 |
| `snr_5_DeepFilterNet3.wav` | 9.686429 | 9.587122 | 9.297464 | 1.8285072 | --- | --- | --- | --- | --- | --- | 4 |
| `snr_10_DeepFilterNet3.wav` | 13.306397 | 13.395801 | 13.216998 | 2.294505 | --- | --- | --- | --- | --- | --- | 5 |

## Третье задание

Запускаем скрипт

```
python code/hw_3.py
```

Код берёт на вход результат предыдущего задания из папки `output/hw_2`, поэтому их нужно запускать последовательно. В результате в папке `output/hw_3` появятся 4 файла -- улучшенные версии из предыдущего задания, т.е. результат работы `DeepFilterNet`. Также он прогоняет их через все достпнуые в `torchmetric` метрики и выводит результат. Также они сведены в таблице выше.
