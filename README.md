## Предварительно
Понятное дело, сперва клонируем репозиторий.

Далее создаём чистое виртуальное украшение, а затем устанавливаем все зависимости через `poetry`

```
poetry install
```

А затем скачиваем данные через `dvc`

```
dvc pull
```

## Первое задание

Сперва запускаем скрипт

```
python code/hw_1/enhance_noise.py
```

В результате мы получим файл `output/hw_1/enh_white_noise.wav` - аудио с белым шумом, где мы откорректировали спектр в соответствии с АЧХ колонок.

Далее запускаем скрипт

```
python code/hw_1/restore_rec.py
```

Скрипт берёт на вход исходный улучшенный шум `output/hw_1/enh_white_noise.wav`, его запись с колонок `data/hw_1/white_noise_rec.wav` и запись с колонок тестового файла `data/hw_1/recording.wav`. Получает имульсный отклик из деконцолюции двух файлов с шумом, затем сворачиваем отклик с записью тестового файла и сохраняем `output/hw_1/restore.wav`.

Результаты, мягко говоря, не очень. Что можно улучшить:

1. Микрофон...
2. Тщательнее выровнять записи во времени, но попытки и так были сделаны.

## Второе задание

Запускаем скрипт

```
python code/hw_2.py
```

Код сгенерирует 4 файла с разным `SNR`: -5, 0, 5 и 10 -- и сохранит в папку
`/output/hw_2/`. Также прогонит их через доступные в `torchmetrics` метрики
`SignalDistortionRatio`, `ScaleInvariantSignalDistortionRatio` и
`PerceptualEvaluationSpeechQuality` и выведет результаты. Результаты работы
NISQA лежат в файле `/output/hw_2/NISQA_results.csv`, а результат работы `DNSMOS` представлены в виде
файла `/output/hw_2/dnsmos.csv`. Также все результаты представлены в таблице
ниже.




| файл | SNR | SDR | SI-SDR | PESQ | NISQA(mos_pred) | NISQA(noi_pred) | NISQA(dis_pred) | NISQA(col_pred) | NISQA(loud_pred) | DNSMOS | MOS |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| `snr-5.wav` | -5 | -9.234993 | -9.270756 | 1.0675446 | 0.604121 | 1.378376 | 2.705365 | 1.193014 | 1.404781 | 2.198392 | 1 |
| `snr_0.wav` | 0 | -4.2377 | -4.2515864 | 1.0548806 | 0.729355 | 1.345632 | 2.989924 | 1.434083 | 1.551345 | 2.3233156 | 2 |
| `snr_5.wav` | 5 | 0.766157 | 0.75917494 | 1.0769463 | 1.121786 | 1.315253 | 4.240198 | 2.908588 | 2.477383 | 2.4289048 | 2 |
| `snr_10.wav` | 10 | 5.7700233 | 5.7652206 | 1.1613451 | 2.027135 | 1.249655 | 4.376255 | 3.407032 | 3.099280 | 2.7627323 | 4 |
| `snr_-5_DeepFilterNet3.wav` | 2.1847632 | -0.3247673 | -1.7007704 | 1.1593353 | 2.4909081 | 2.6110985 | 2.886099 | 2.9643068 | 3.1617444 | 3.04381823 | 1 |
| `snr_0_DeepFilterNet3.wav` | 5.974484 | 5.4281497 | 4.793428 | 1.4118621 | 3.184651 | 2.996207 | 4.084453 | 3.7316866 | 3.8693864 | 3.4055948 | 1 |
| `snr_5_DeepFilterNet3.wav` | 9.686429 | 9.587122 | 9.297464 | 1.8285072 | 4.0152526 | 3.7126563 | 4.3300858 | 4.124518 | 4.21834 | 3.938565 | 4 |
| `snr_10_DeepFilterNet3.wav` | 13.306397 | 13.395801 | 13.216998 | 2.294505 | 4.4459743 | 4.2683206 | 4.5119596 | 4.273391 | 4.426126 | 3.994667 | 5 |


В нашем случае перцептуальные метрики меняются незначительно, аналитические же разнятся в широком спектре значений. На мой взгляд, будто аналитические метрики здесь показывают себя лучше. Так, DNSMOS оценивает все файлы одинаково, в том время как разница в качестве между худшим и лучшим файлами очеивдно и разительна.

С NISQA чуть получше, но опять-таки изменения не стол значительны, как у аналитических. Но, опять-таки, эта оценка достаточно субъективна

## Третье задание

Запускаем скрипт

```
python code/hw_3.py
```

Код берёт на вход результат предыдущего задания из папки `output/hw_2`, поэтому их нужно запускать последовательно. В результате в папке `output/hw_3` появятся 4 файла -- улучшенные версии из предыдущего задания, т.е. результат работы `DeepFilterNet`. Также он прогоняет их через все достпнуые в `torchmetric` метрики и выводит результат. Результаты работы NISQA лежат в файле `/output/hw_3/NISQA_results.csv`, а результат работы `DNSMOS` представлены в виде файла `/output/hw_3/dnsmos.csv`.  Также все метрики сведены в таблице выше.

Перцептуальные метрики ведут себя достаточно забавным образом. Так, DNSMOS оценивает худший из результатов этого этапа лучше чем самый лучший файл из предыдущего задания, что объективно неправда, так как в `snr_-5_DeepFilterNet3.wav` в конце вообще ничего не разобрать. То же самое можно сказать не только про NISQA, но и про аналитические метрики. Тут еще более видна корелляция между ними, но не с реальным качеством аудио.

Можно сделать вывод, что никакая метрика не является "панацеей", и порой более высокие значения любой из них могут ничего не говорить.
